!function(a){"use strict";function t(a){this.model={data:null,host:""},this.init(a)}a="default"in a?a.default:a;var e='<a class="center-item" href="javascript:;" data-bind="attr: { href: getExamPrepareUrl(), title: model.data.unit_info.title }"\r\n  target="_blank">\r\n  <h5 class="item-title" data-bind="text: model.data.unit_info.title"></h5>\r\n  <div class="item-info clearfix">\r\n    <ul class="info-fl fl" data-bind="css: { pt1 : !ko.unwrap(model.data.unit_info.extra.duration) || (ko.unwrap(model.data.extra.remain_chance) <= 0) || getExamStatus() == \'70\', pt2: (!ko.unwrap(model.data.unit_info.extra.duration) && (ko.unwrap(model.data.extra.remain_chance) <= 0)) || (getExamStatus() == \'70\' && !ko.unwrap(model.data.unit_info.extra.duration)) }">\r\n      <!-- ko if: ko.unwrap(model.data.extra.remain_chance) > 0 && getExamStatus() !== \'70\' -->\r\n      <li>\r\n        <i>•</i>\r\n        <span class="info" data-bind="translate:{ key:\'exam_unitcard.examTimes\', properties:{ count: ko.unwrap(model.data.extra.remain_chance) } },visible: getExamStatus() !== \'70\'"></span>\r\n      </li>\r\n      <!--/ko-->\r\n      <li>\r\n        <i>•</i>\r\n        <span class="info" data-bind="translate:{ key:\'exam_unitcard.totalAndPassingScore\', properties:{ totalScore: formatScore(ko.unwrap(model.data.unit_info.extra.total_score)), passingScore:formatScore(ko.unwrap(model.data.unit_info.extra.passing_score)) } }"></span>\r\n      </li>\r\n      <!--ko if: model.data.unit_info.extra.duration -->\r\n      <li>\r\n        <i>•</i>\r\n        <span class="info" data-bind="translate:{ key:\'exam_unitcard.duration\', properties:{ count: Math.floor(model.data.unit_info.extra.duration / 60) } },visible: getExamStatus() !== \'70\'"></span>\r\n      </li>\r\n      <!--/ko-->\r\n    </ul>\r\n    <div class="info-fr fr" style="display: none;" data-bind="css: { \'failed\': ko.unwrap(model.data.extra.pass_status) == -1 }, visible: (ko.unwrap(model.data.extra.last_status) == 32 || ko.unwrap(model.data.extra.last_status) == 96)">\r\n      <p data-bind="translate: { key: \'exam_unitcard.scoreMark\', properties:{ count: formatScore(ko.unwrap(model.data.extra.best_scores)) } }"></p>\r\n      <p data-bind="visible: ko.unwrap(model.data.extra.pass_status) == -1, translate: { key: \'exam_unitcard.failed\' }"></p>\r\n      <p data-bind="visible: ko.unwrap(model.data.extra.pass_status) == 1, translate: { key: \'exam_unitcard.passed\' }"></p>\r\n    </div>\r\n  </div>\r\n  <div class="item-ft">\r\n    <p class="ft-fl fl" data-bind="html: formatDateTime($data)"></p>\r\n    <span class="ft-fr fr btn btn-primary" data-bind="css: { \'btn-default\': disableBtn() }, translate: { key:userExamStatus($data) }"></span>\r\n  </div>\r\n</a>';t.prototype={init:function(a){this.model.data=a.model,this.model.host=a.host},formatDateTime:function(t){var e,n="",r=a.mapping.toJS(t.model.data.unit_info.extra);return"60"==this.getExamStatus()||"70"==this.getExamStatus()?(e=r.end_time?r.end_time.split("T"):"",n=r.end_time?e[0]+" "+e[1].substr(0,5)+'<em class="ml">'+i18nHelper.getKeyValue("exam_unitcard.ending")+"</em>":""):(e=r.begin_time?r.begin_time.split("T"):"",n=e[0]+" "+e[1].substr(0,5)+'<em class="ml">'+i18nHelper.getKeyValue("exam_unitcard.starting")+"</em>"),n},formatScore:function(a){return a?+a.toFixed(1):0},getExamPrepareUrl:function(){return this.model.host+"/exam/prepare/"+a.unwrap(this.model.data.unit_id)},disableBtn:function(){var t=-1,e=a.mapping.toJS(this.model.data.extra);switch(this.getExamStatus()){case 50:case 70:t=1;break;case 60:switch(e.last_status){case 16:case 101:t=1;break;case 32:t=e.remain_chance<=0?1:0;break;default:t=0}}return t},userExamStatus:function(t){var e="",n=a.mapping.toJS(t.model.data.extra);switch(n.last_status){case 1:e="exam_unitcard.aboutToBegin";break;case 4:e="exam_unitcard.start";break;case 8:case 112:e="exam_unitcard.continueExam";break;case 16:case 101:e="exam_unitcard.waitForCorrect";break;case 32:e=n.remain_chance<=0?"exam_unitcard.noChance":"exam_unitcard.restart";break;case 0:case 64:case 80:case 96:e="exam_unitcard.end"}return e},getExamStatus:function(){var t=a.mapping.toJS(this.model.data.extra);switch(t.last_status){case 16:case 101:case 32:return 60;case 0:case 64:case 80:case 96:return 70}}},a.components.register("x-examcard",{viewModel:t,template:e})}(ko);
