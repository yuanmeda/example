!function(t,e){"use strict";t="default"in t?t["default"]:t,e="default"in e?e["default"]:e;t.components.register("x-course-lecturers",{viewModel:function(){var n=this,s=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.host=s.host||"http://lecturer-gateway.dev.web.nd",this.csHost=s.csHost||"https://betacs.101.com/v0.1",/\/v/.test(this.csHost)||(/\/$/.test(this.csHost)?this.csHost+="v0.1":this.csHost+="/v0.1"),this.avatavClickHandler=s.handler,this.items=t.observableArray([]),this.showMore=t.observable(!1),this.fetching=t.observable(!0),this.page=0,this.total=t.observable(0);var a=s.id,i=s.csCDN,o=i===undefined?"http://cdncs.101.com/v0.1/static/cscommon/avatar/2000336579/2000336579.jpg?size=80&defaultImage=1":i,r=function(t){return n.csHost+"/download?dentryId="+t},c=function(t){return t.photo_id?t.photo_id=r(t.photo_id)+"&size=80":t.photo_id=o,t.nick_name||(t.nick_name=""),t};this.getCourse=function(){a&&e.ajax(n.host+"/v1/lecturers/search?course_id="+a+"&page_no="+n.page+"&page_size=3&enable=1",{success:function(t){n.total(t.total),n.fetching(!1),(t.items||[]).map(function(t){n.items.push(c(t))})},error:function(t){n.fetching(!1),t.global=!1}})},this.getCourse(),this.handleAvatarError=function(t,e){e.target.src!==o&&(e.target.src=o)},this.handleAvatarClick=function(t,e){"function"==typeof n.avatavClickHandler&&n.avatavClickHandler(t,e)},this.showMoreItems=function(){n.items().length<n.total()&&(n.page=n.page+1,n.getCourse(),n.fetching(!0),n.showMore(!0))},this.hideMoreItems=function(){for(;3!==n.items().length;)n.items.pop();n.page=0,n.showMore(!1)}},template:'<div class="sidebox boxs" data-bind="visible: items().length">\n    <div class="course-lecturers-view">\n        <div class="lecturer-title"><!--ko translate:{key:\'lecturer.title\'}--><!--/ko--></div>\n        <!-- ko if:items().length -->\n        <ul class="course-lecturer-list" data-bind="foreach: items">\n            <li class="course-lecturer-item">\n                <div class="lecturer-info">\n                    <div class="lecturer-avatar">\n                        <img data-bind="attr: {src: photo_id}, event: {error: $parent.handleAvatarError, click: $parent.handleAvatarClick}"/>\n                    </div>\n                    <div class="lecturer-name">\n                        <span data-bind="text: name"></span>\n                        <span class="lecturer-nickname" data-bind="text: nick_name ? \'(\' + nick_name + \')\' : \'\'"></span>\n                    </div>\n                </div>\n                <!-- ko if: intro -->\n                <div class="lecturer-intro" data-bind="text: intro"></div>\n                <!-- /ko -->\n            </li>\n        </ul>\n        <!-- /ko -->\n        <!-- ko if: total() > 3 -->\n        <div class="lecturer-more">\n            <div>\n                <!-- ko if: showMore() -->\n                <button class="lecturer-button lecturer-button-collapse" data-bind="event: {click: hideMoreItems}">\n                    <span><!--ko translate:{key:\'lecturer.collapse\'}--><!--/ko--></span>\n                </button>\n                <!-- /ko -->\n            </div>\n            <div>\n                <!-- ko if: items().length < total() && !fetching() -->\n                <button class="lecturer-button lecturer-button-more" data-bind="event: {click: showMoreItems}">\n                    <span><!--ko translate:{key:\'lecturer.more\'}--><!--/ko--></span>\n                </button>\n                <!-- /ko -->\n            </div>\n            <!-- /ko -->\n        </div>\n        <!-- /ko -->\n        <!-- ko if:items().length < 1 -->\n        <div class="course-lecturers-no-data">\n            <p class="no-data-prompt"><!--ko translate:{key:\'lecturer.nodata\'}--><!--/ko--></p>\n        </div>\n        <!-- /ko -->\n    </div>\n</div>\n'})}(ko,$);
